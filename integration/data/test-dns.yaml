apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: test-dns
  labels: {test: dns}
spec:
  selector:
    matchLabels: {test: dns}
  template:
    metadata:
      labels: {test: dns}
    spec:
      nodeSelector:
        used-for: test-pods
      containers:
      - image: public.ecr.aws/docker/library/busybox:1.36.1
        name: dns-test-cluster
        stdin: true
        tty: true
        readinessProbe:
          initialDelaySeconds: 0
          periodSeconds: 3
          failureThreshold: 3
          timeoutSeconds: 1
          exec:
            command:
            - nslookup
            - kubernetes.default.svc.cluster.local.
      - image: public.ecr.aws/docker/library/busybox:1.36.1
        name: dns-test-eksctl
        stdin: true
        tty: true
        readinessProbe:
          initialDelaySeconds: 0
          periodSeconds: 3
          failureThreshold: 3
          timeoutSeconds: 1
          exec:
            command:
            - nslookup
            - eksctl.io
      - image: public.ecr.aws/docker/library/busybox:1.36.1
        name: dns-test-k8s
        stdin: true
        tty: true
        readinessProbe:
          initialDelaySeconds: 0
          periodSeconds: 3
          failureThreshold: 3
          timeoutSeconds: 1
          exec:
            command:
            - nslookup
            - k8s.io
      - image: public.ecr.aws/docker/library/busybox:1.36.1
        name: dns-test-kubernetes
        stdin: true
        tty: true
        readinessProbe:
          initialDelaySeconds: 0
          periodSeconds: 3
          failureThreshold: 3
          timeoutSeconds: 1
          exec:
            command:
            - nslookup
            - kubernetes.io
      - image: public.ecr.aws/docker/library/busybox:1.36.1
        name: dns-test-eks-us
        stdin: true
        tty: true
        readinessProbe:
          initialDelaySeconds: 0
          periodSeconds: 3
          failureThreshold: 3
          timeoutSeconds: 1
          exec:
            command:
            - nslookup
            - EKS.us-east-1.amazonaws.com
      - image: public.ecr.aws/docker/library/busybox:1.36.1
        name: dns-test-eks-eu
        stdin: true
        tty: true
        readinessProbe:
          initialDelaySeconds: 0
          periodSeconds: 3
          failureThreshold: 3
          timeoutSeconds: 1
          exec:
            command:
            - nslookup
            - EKS.eu-west-1.amazonaws.com
      - image: public.ecr.aws/docker/library/busybox:1.36.1
        name: dns-test-ec2-us
        stdin: true
        tty: true
        readinessProbe:
          initialDelaySeconds: 0
          periodSeconds: 3
          failureThreshold: 3
          timeoutSeconds: 1
          exec:
            command:
            - nslookup
            - ec2.us-east-2.amazonaws.com
      - image: public.ecr.aws/docker/library/busybox:1.36.1
        name: dns-test-ec2-eu
        stdin: true
        tty: true
        readinessProbe:
          initialDelaySeconds: 0
          periodSeconds: 3
          failureThreshold: 3
          timeoutSeconds: 1
          exec:
            command:
            - nslookup
            - ec2.eu-west-2.amazonaws.com
      - image: public.ecr.aws/docker/library/busybox:1.36.1
        name: dns-test-ifconfig
        stdin: true
        tty: true
        readinessProbe:
          initialDelaySeconds: 0
          periodSeconds: 3
          failureThreshold: 3
          timeoutSeconds: 1
          exec:
            command:
            - nslookup
            - ifconfig.co
